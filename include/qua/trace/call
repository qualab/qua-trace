#pragma once

#include <qua/trace/export>
#include <memory>

#define QUA_TRACE_CALL  ::qua::trace::call _qua_trace_call(__func__, __FILE__, __LINE__)

namespace qua
{
    namespace trace
    {
        class qua_trace_public call
        {
        public:
            call(const char* name, const char* file, long long line);
            ~call();

            const char* get_name() const;
            const char* get_file() const;
            long long get_line() const;
            
            class stack;

        private:
            class data;

            std::shared_ptr<data> m_data;
        };

        class qua_trace_public call::stack
        {
        public:
            static const call& get_call(size_t offset = 0);

        private:
            stack();
            stack(stack&&);
            stack(const stack&);
        };
    }
}
